# üìñ Kunpeng Novel ‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏ô‡∏¥‡∏¢‡∏≤‡∏¢‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢ - ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

## üß≠ ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°

‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏ô‡∏¥‡∏¢‡∏≤‡∏¢‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏≠‡πà‡∏≤‡∏ô ‡∏ô‡∏±‡∏Å‡πÅ‡∏õ‡∏• ‡πÅ‡∏•‡∏∞‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô ‡∏°‡∏µ‡∏£‡∏∞‡∏ö‡∏ö‡∏°‡∏≤‡∏£‡πå‡∏Å‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î Responsive ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î

---

## üîê ‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ (Authentication)

### ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏Å

* **Supabase Auth**
* **Login** (Email/Password, Google OAuth)
* **Register** (‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÑ‡∏î‡πâ‡πÄ‡∏≠‡∏á, default role = `reader`)
* **Forgot Password** (email reset link)
* **Roles**: `reader`, `vip`, `editor`, `admin`
* **VIP**: field `is_vip: boolean`, `vip_expires_at: timestamp` (admin ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤)

---

## üß≠ ‡πÄ‡∏°‡∏ô‡∏π‡∏ô‡∏≥‡∏ó‡∏≤‡∏á (Navigation)

### ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (‡∏´‡∏•‡∏±‡∏á‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô)

| ‡∏´‡∏ô‡πâ‡∏≤         | URL                | ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢            |
| ------------ | ------------------ | ------------------- |
| ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô      | `/login`           | ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö         |
| ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å  | `/register`        | ‡πÄ‡∏õ‡∏¥‡∏î‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÉ‡∏´‡∏°‡πà       |
| ‡∏•‡∏∑‡∏°‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô  | `/forgot-password` | ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô      |
| ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏¥‡∏¢‡∏≤‡∏¢ | `/novels`          | ‡πÅ‡∏™‡∏î‡∏á‡∏ô‡∏¥‡∏¢‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î    |
| ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå      | `/profile`         | ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏±‡∏ç‡∏ä‡∏µ, Logout |

### Navbar (‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏° Role)

| Role   | ‡πÄ‡∏°‡∏ô‡∏π                            |
| ------ | ------------------------------- |
| reader | Novels, Bookmarks, VIP, Profile |
| vip    | Novels, Bookmarks, VIP, Profile |
| editor | Editor Dashboard, Profile       |
| admin  | Admin Dashboard, Users, Profile |

---

## üìö ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏ô‡∏¥‡∏¢‡∏≤‡∏¢ (Novel Features)

### ‡∏™‡∏£‡πâ‡∏≤‡∏á/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ô‡∏¥‡∏¢‡∏≤‡∏¢

* **Fields**: title, description, cover, genre, tags
* **Access Control**: Checkbox for `reader`, `vip`, `editor` ‚Üí `access_roles: text[]`
* **Editor Mode**: `editor_mode: boolean` (‡πÄ‡∏õ‡∏¥‡∏î‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏°‡∏≤‡∏£‡πå‡∏Å)

### ‡∏™‡∏£‡πâ‡∏≤‡∏á/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ö‡∏ó

* **Fields**: title, content, status(`draft`/`published`)
* **Access Control**: Checkbox for `reader`, `vip`, `editor`
* **Lock Chapter**: `is_locked: boolean` + `password: text` (option)

---

## üìñ ‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡πà‡∏≤‡∏ô‡∏ï‡∏≠‡∏ô (`/novel/:id/chapter/:cid`)

> **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡πà‡∏≠‡∏ô**: user.role ‚àà `chapter.access_roles` ‡πÅ‡∏•‡∏∞‡∏ñ‡πâ‡∏≤ `is_locked` ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™

### 1. Reader Mode

* A+ / A- (‡∏õ‡∏£‡∏±‡∏ö‡∏ü‡∏≠‡∏ô‡∏ï‡πå)
* Light / Dark Theme
* Bookmark Chapter (üîñ)
* Prev / Next Chapter

### 2. Editor Mode

> **‡πÄ‡∏â‡∏û‡∏≤‡∏∞ role=`editor`|`admin` ‡πÅ‡∏•‡∏∞ `editor_mode = true`**

#### 2.1 Sticky Toolbar

* ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á: ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô, ‡∏ï‡∏¥‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô (position: sticky; top: 0; z-index:50)
* ‡∏õ‡∏∏‡πà‡∏°:

  ```text
  A+ | A- | üîñ | üìã Copy Marks | << Prev | Next >>
  ```
* ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏õ‡∏£‡∏±‡∏ö‡∏ü‡∏≠‡∏ô‡∏ï‡πå, ‡∏ö‡∏∏‡πä‡∏Ñ‡∏°‡∏≤‡∏£‡πå‡∏Å, ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏£‡πå‡∏Å ‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏õ‡∏ö‡∏ó‡∏Å‡πà‡∏≠‡∏ô/‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢‡∏ï‡∏•‡∏≠‡∏î

#### 2.2 ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î

```jsx
<div className="line-row">
  <span className="line-number">3</span>
  <span className="line-text">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà 3</span>
  <input type="checkbox" className="line-checkbox" />
</div>
```

* **‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î**: ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏•‡∏Ç‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö
* **Checkbox**: ‡∏°‡∏≤‡∏£‡πå‡∏Å/‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å ‚Üí ‡πÑ‡∏Æ‡πÑ‡∏•‡∏ï‡πå‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á
* **Double-click**: ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î (‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏°‡πÄ‡∏•‡∏Ç)
* **Popup**: ‡πÅ‡∏™‡∏î‡∏á ‚Äú‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß ‚úì‚Äù ‡∏´‡∏£‡∏∑‡∏≠ ‚Äú‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß ‚úì‚Äù 2 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ

#### 2.3 Copy Marks Function

* ‡∏õ‡∏∏‡πà‡∏° üìã ‡∏à‡∏∞‡∏î‡∏∂‡∏á `marked_lines_json` ‡∏Ç‡∏≠‡∏á user+chapter
* ‡∏≠‡πà‡∏≤‡∏ô `chapters.content` ‡∏ï‡∏≤‡∏° `line_number`
* ‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏° newline
* ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏õ clipboard + popup ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô

---

## üíæ ‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Supabase)

### ‡∏ï‡∏≤‡∏£‡∏≤‡∏á `novels`

```sql
create table novels (
  id uuid primary key default uuid_generate_v4(),
  title text,
  description text,
  cover_url text,
  genre text,
  tags text[],
  access_roles text[] default array['reader'],
  editor_mode boolean default false
);
```

### ‡∏ï‡∏≤‡∏£‡∏≤‡∏á `chapters`

```sql
create table chapters (
  id uuid primary key default uuid_generate_v4(),
  novel_id uuid references novels(id),
  title text,
  content text,
  status text default 'draft',
  access_roles text[] default array['reader'],
  is_locked boolean default false,
  password text
);
```

### ‡∏ï‡∏≤‡∏£‡∏≤‡∏á `line_marks`

```sql
create table line_marks (
  id uuid primary key default uuid_generate_v4(),
  user_id uuid references auth.users(id),
  chapter_id uuid references chapters(id),
  marked_lines_json jsonb,
  updated_at timestamp default now()
);
```

* **RLS**: policy ‡πÉ‡∏´‡πâ user ‡πÄ‡∏´‡πá‡∏ô/‡πÅ‡∏Å‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô

### ‡∏ï‡∏≤‡∏£‡∏≤‡∏á `auth.users`

```sql
alter table auth.users
add column role text default 'reader',
add column is_vip boolean default false,
add column vip_expires_at timestamp;
```

---

## ‚öôÔ∏è Tech Stack

* **Frontend**: Next.js, React, Tailwind CSS
* **Backend**: Supabase (Auth, Database, Realtime)
* **Hosting**: Vercel

---

## üîê ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢

* Login guard ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô
* ‡∏ï‡∏£‡∏ß‡∏à `role` ‡πÅ‡∏•‡∏∞ `access_roles` ‡∏ó‡∏±‡πâ‡∏á‡∏ù‡∏±‡πà‡∏á client & server
* RLS ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Ç‡πâ‡∏≤‡∏° user

---

## üõ† ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ï‡πà‡∏≠‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï

* Export/Import `line_marks`
* Workflow ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏•‡∏´‡∏•‡∏≤‡∏¢‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô
* ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤/‡∏Å‡∏£‡∏≠‡∏á‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏£‡πå‡∏Å
* Markdown preview ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö editor

---

> ¬© 2025 Kunpeng Novel. Freedom for translators, quality for readers.
